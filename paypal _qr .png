<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>꙰ my-omniverse-store</title>
  <style>
    body { font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Noto Sans", "Helvetica Neue", Arial; margin:0; padding:24px; background:#f7f7f9; color:#111; }
    .wrap { max-width:980px; margin:0 auto; }
    header { text-align:center; margin-bottom:18px; }
    h1 { margin:6px 0; font-size:22px; }
    p.lead { color:#444; margin:6px 0 18px; }
    .grid { display:grid; grid-template-columns: repeat(auto-fit, minmax(220px,1fr)); gap:12px; }
    .card { background:#fff; border-radius:10px; padding:12px; box-shadow:0 4px 14px rgba(20,20,30,0.04); }
    .card h3 { margin:8px 0 6px; font-size:16px; }
    .meta { font-size:12px; color:#666; margin-bottom:8px; }
    .actions { display:flex; gap:8px; }
    .btn { padding:8px 10px; border-radius:8px; text-decoration:none; font-weight:600; font-size:13px; }
    .btn-primary { background:#0b79ff; color:#fff; }
    .btn-outline { border:1px solid #ddd; color:#333; background:transparent; }
    footer { margin-top:22px; text-align:center; color:#555; font-size:14px; }
    .qr { max-width:140px; margin:12px auto 0; display:block; border-radius:8px; box-shadow:0 6px 18px rgba(10,10,20,0.06); }
    .notice { font-size:13px; color:#666; margin-top:10px; }
    pre { white-space:pre-wrap; word-break:break-word; }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div style="font-size:28px">꙰ <strong>my-omniverse-store</strong></div>
      <h1>Digital assets & downloads — Powered by GitHub Pages</h1>
      <p class="lead">Assets served from <code>/assets/</code>. Add .zip/.gltf/.usd/.blend etc. to the assets folder to publish items.</p>
    </header>

    <section id="products">
      <div id="loader">Loading products…</div>
    </section>

    <footer>
      <div>Support / Donate — scan PayPal QR or click the donation link below</div>
      <img src="paypal_qr.png" alt="PayPal QR" class="qr" />
      <div class="notice">Downloaded assets are provided by the store owner. Please respect licenses. For donations use PayPal.</div>
    </footer>
  </div>

<script>
async function loadProducts(){
  const container = document.getElementById('products');
  container.innerHTML = '';
  try {
    const res = await fetch('products.json', {cache:'no-store'});
    if(!res.ok) throw new Error('products.json not found');
    const products = await res.json();
    if(!Array.isArray(products) || products.length===0){
      container.innerHTML = '<div style="text-align:center;color:#666">No products yet. Upload files to <code>assets/</code> to publish.</div>';
      return;
    }
    const grid = document.createElement('div'); grid.className = 'grid';
    products.forEach(p=>{
      const card = document.createElement('div'); card.className='card';
      const title = document.createElement('h3'); title.textContent = p.title || p.filename;
      const meta = document.createElement('div'); meta.className='meta';
      meta.innerHTML = `${p.size || ''} ${p.type ? ' • ' + p.type : ''} ${p.note ? ' • ' + p.note : ''}`;
      const desc = document.createElement('div'); desc.style.margin='8px 0 12px'; desc.textContent = p.description || '';
      const actions = document.createElement('div'); actions.className='actions';
      const dl = document.createElement('a'); dl.className='btn btn-primary'; dl.href = p.url; dl.textContent='Download'; dl.setAttribute('download','');
      const info = document.createElement('a'); info.className='btn btn-outline'; info.href = '#'; info.textContent='Details';
      info.onclick = (e)=>{ e.preventDefault(); alert((p.description||'') + '\\n\\nFile: ' + p.filename); }
      actions.appendChild(dl); actions.appendChild(info);
      card.appendChild(title); card.appendChild(meta); card.appendChild(desc); card.appendChild(actions);
      grid.appendChild(card);
    });
    container.appendChild(grid);
  } catch(err){
    container.innerHTML = '<div style="text-align:center;color:#a33">Could not load products.json — see README for auto-generation steps.</div>';
    console.error(err);
  }
}
loadProducts();
</script>
</body>
</html>

